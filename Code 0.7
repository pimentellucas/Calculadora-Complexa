#include <stdio.h>
#include <stdlib.h>
#include <math.h>

//printf("%.2lf\n", a2 );
//printf("%.2lf\n", b2 );
//printf("%.2lf\n", c2 );
//printf("%.2lf\n", d2 );

//FAZER INSTRUÇOES DE USO
int main()
{
//Leitura da Sentença

char soma[150];
int n,sinala,sinalb,tiponum1,operacao,sinalc,sinald,tiponum2;
double a,b,c,d,a2,b2,c2,d2,pi,resr,resi;

n = 0;
a = 0;
sinala = 0;             //0=+ 1=-
b = 0;
sinalb = 0;             //0=+ 1=-
tiponum1 = 0;
c = 0;
sinalc = 0;             //0=+ 1=-
d = 0;
sinald = 0;             //0=+ 1=-
tiponum2 = 0;
a2 = 0;
b2 = 0;
c2 = 0;
d2 = 0;
pi = 3.14159265358979323846;


printf ( "Digite a operacao :\n" );
scanf("%[^\n]c", soma); //lê o string sem parar ao dar espaço;

if (soma[0] == 45){
    sinala = 1;
    n = n+1;                                        // se o primeiro numero comecar com -
}

    while (soma[n] != 43 && soma[n] != 45){
            a = (a * 10) + (soma[n] - 48);
            n = n + 1;                              //reconhece o numero e associa ele a "a"
}
if (soma[n] == 45){
    sinalb = 1;                // para o sinal de b = -
}
n = n+1;

    while (soma[n] != 105  && soma[n] != 112){
            b = (b * 10) + (soma[n] - 48);
            n = n + 1;                              //reconhece o numero e associa ele a "b"
}

if(soma[n] == 112){
    tiponum1 = 1;           //se o número for Polar
}
n = n+1;



if(soma[n] == 43){              //Soma
  operacao = 0;}
    else
        if(soma[n] == 45){              //Subtração
    operacao = 1;}
        else
            if(soma[n] == 42){              //multiplicação
        operacao = 2;}
            else
                if(soma[n] == 47){              //Divisão
            operacao = 3;}
                else
                    if(soma[n] == 94){              // Potencia
                operacao = 4;}
                        else
                        operacao = 5;                 // Converter Polar retangular

n = n+1;

if (soma[n] == 45){
    sinalc = 1;
    n = n+1;                // para o sinal de b = -
}
if (soma[n] == 43){
    sinalc = 0;
    n = n+1;                // para o sinal de b = +
}


    while (soma[n] != 43 && soma[n] != 45){
            c = (c * 10) + (soma[n] - 48);
            n = n + 1;                              //reconhece o numero e associa ele a "c"
}
if (soma[n] == 45){
    sinald = 1;                // para o sinal de b = -
}
n = n+1;

    while (soma[n] != 105  && soma[n] != 112){
            d = (d * 10) + (soma[n] - 48);
            n = n + 1;                              //reconhece o numero e associa ele a "d"
}

if(soma[n] == 112){
    tiponum2 = 1;           //se o número for Polar
}


if (tiponum1 == 1){
    a2 = b * pi/180;
    a2 = cos(a2) * a;
    b2 = b * pi/180;
    b2 = sin(b2) * a;


}
if (tiponum2 == 1){
    c2 = d * pi/180;
    c2 = cos(c2) * c;
    d2 = d * pi/180;
    d2 = sin(d2) * c;
}

//SOMA
if (operacao == 0){
    if(tiponum1 == 0 && tiponum2 == 0){
        resr = a+c;
        resi = b+d;
        printf("o resultado e:\n");
        printf("%.2lf + %.2lf i", resr, resi);}
    else
        if( tiponum1 == 1 && tiponum2 == 1){
            resr = a2+c2;
            resi = b2+d2;
            printf("o resultado e:\n");
            printf("%.2lf + %.2lf i", resr, resi);}
        else
            if(tiponum1 == 0 && tiponum2 == 1){
                resr = a+c2;
                resi = b+d2;
                printf("o resultado e:\n");
                printf("%.2lf + %.2lf i", resr, resi);}
                else
                    if(tiponum1 == 1 && tiponum2 == 0){
                        resr = a2+c;
                        resi = b2+d;
                        printf("o resultado e:\n");
                        printf("%.2lf + %.2lf i", resr, resi);}
}
//SUBTRAÇÂO
if (operacao == 1){
    if(tiponum1 == 0 && tiponum2 == 0){
        resr = a-c;
        resi = b-d;
        printf("o resultado e:\n");
        printf("%.2lf + %.2lf i", resr, resi);}
    else
        if( tiponum1 == 1 && tiponum2 == 1){
            resr = a2-c2;
            resi = b2-d2;
            printf("o resultado e:\n");
            printf("%.2lf + %.2lf i", resr, resi);}
        else
            if(tiponum1 == 0 && tiponum2 == 1){
                resr = a-c2;
                resi = b-d2;
                printf("o resultado e:\n");
                printf("%.2lf + %.2lf i", resr, resi);}
                else
                    if(tiponum1 == 1 && tiponum2 == 0){
                        resr = a2-c;
                        resi = b2-d;
                        printf("o resultado e:\n");
                        printf("%.2lf + %.2lf i", resr, resi);}
}
//MULTIPLICAÇÃO
if (operacao == 2){
    if(tiponum1 == 0 && tiponum2 == 0){
        resr = (a*c)-(b*d);
        resi = (a*d)+(b*c);
        printf("o resultado e:\n");
        printf("%.2lf + %.2lf i", resr, resi);}
    else
        if( tiponum1 == 1 && tiponum2 == 1){
            resr = (a2*c2)-(b2*d2);
            resi = (a2*d2)+(b2*c2);
            printf("o resultado e:\n");
            printf("%.2lf + %.2lf i", resr, resi);}
        else
            if(tiponum1 == 0 && tiponum2 == 1){
                resr = (a*c2)-(b*d2);
                resi = (a*d2)+(b*c2);
                printf("o resultado e:\n");
                printf("%.2lf + %.2lf i", resr, resi);}
                else
                    if(tiponum1 == 1 && tiponum2 == 0){
                        resr = (a2*c)-(b2*d);
                        resi = (a2*d)+(b2*c);
                        printf("o resultado e:\n");
                        printf("%.2lf + %.2lf i", resr, resi);}
}
//DIVISÃO
if (operacao == 3){
    if(tiponum1 == 0 && tiponum2 == 0){
        resr = ((a*c)-(b*d))/((c*c)+(d*d));
        resi = ((b*c)-(a*d))/((c*c)+(d*d));
        printf("o resultado e:\n");
        printf("%.2lf + %.2lf i", resr, resi);}
    else
        if( tiponum1 == 1 && tiponum2 == 1){
            resr = ((a2*c2)-(b2*d2))/((c2*c2)+(d2*d2));
            resi = ((b2*c2)-(a2*d2))/((c2*c2)+(d2*d2));
            printf("o resultado e:\n");
            printf("%.2lf + %.2lf i", resr, resi);}
        else
            if(tiponum1 == 0 && tiponum2 == 1){
                resr = ((a*c2)-(b*d2))/((c2*c2)+(d2*d2));
                resi = ((b*c2)-(a*d2))/((c2*c2)+(d2*d2));
                printf("o resultado e:\n");
                printf("%.2lf + %.2lf i", resr, resi);}
                else
                    if(tiponum1 == 1 && tiponum2 == 0){
                        resr = ((a2*c)-(b2*d))/((c*c)+(d*d));
                        resi = ((b2*c)-(a2*d))/((c*c)+(d*d));
                        printf("o resultado e:\n");
                        printf("%.2lf + %.2lf i", resr, resi);}
}
return 0;
}
